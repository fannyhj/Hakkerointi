# h4 Some Disassembly Required

## x) GHIDRA for Reverse Engineering (PicoCTF 2022 #42 'bbbloat') John Hammond


- Ghidra on ilmainen, avoimen lähdekoodin käänteinen ohjelmisto NSA: lta.

- Pääkomponentit: CodeBrowser, Decompiler, Symbolipuu, Listing, Decompiler-ikkuna.

- Automaattianalyysi tekee suurimman osan raskaista nostoista, mutta manuaalinen puhdistus on välttämätöntä.

- Lataa binääri → suorita automaattinen analyysi.

- Paikanna main() (usein Symbol tree:n kautta).
 
- Etsi vertailuja, silmukoita ja muunnoksia.

- Nimeä muuttujat uudelleen, kun niiden tarkoitus tulee selväksi.

- L muuttaa muuttujia uudelleen

- R funktioiden uudelleennimeämiseen

- Tietotyypin leviäminen logiikan selventämiseksi

- Luota kokoonpanoon, kun decompiler-tuotos näyttää epäilyttävältä.



## a) Lataa Ghidra

Aloitin lataamalla javan komennolla sudo apt install -y openjdk-17-jdk, mutta ei toiminut. Tämä oli vanha versio, joten tarkistin ajankohtaisen version komennolla apt search openjdk ja löysin, että lataukseen
pitää käyttää versiota 21.

Latasin sitten tämän komennolla sudo apt install -y openjdk-21-jdk ja tarkistin java -version. Kuva alla:


<img width="934" height="102" alt="image" src="https://github.com/user-attachments/assets/b0b4dfe2-8aaf-4313-91f8-325f20f924d6" />


Latasin sitten wgetillä Ghidran githubista (https://github.com/NationalSecurityAgency/ghidra/releases).

Tämän jälkeen unzippasin tiedoston ja käynnistin ghidran:

cd ghidra_10.4.1_PUBLIC
./ghidraRun


<img width="500" height="775" alt="image" src="https://github.com/user-attachments/assets/979dccc2-dd1a-4e12-856d-e1199acc89d0" />


Tein sitten ghidran graafisessa näkymässä uuden projektin.

## b) rever-C


Avasin sitten code browserin ja yritin etsiä etsiä main funktion, mutta semmoista ei ollut niin aluksi oletin, että se olisi FUN_0010578d ja uudelleennimesin sen main:iksi.

<img width="288" height="272" alt="image" src="https://github.com/user-attachments/assets/7d09b3f0-cb1b-4a98-9cf4-8226c748f6dd" />

Tämän jälkeen katsoin, että FUN_0010574f ei callaa enää mitään niin vaihdoin sen main:iksi, koska en ollut taaskaan ihan varma.

Valitsin sitten "window" ja "defined strings" ja huomasin kohdan jossa luki "What's the password?".

<img width="1041" height="364" alt="image" src="https://github.com/user-attachments/assets/6bf625aa-9fe4-491f-b83d-e6d314c8daea" />

Yritin käyttää tehtävään linkattua videota "GHIDRA for Reverse Engineering (PicoCTF 2022 #42 'bbbloat') John Hammond" apuna, mutta hänen projektinsa oli aika erilainen, joten siitä ei ollut
hirveästi apua. Yritin pitkään etsiä jotain millä olisin päässyt tästä eteenpäin, mutta en löytänyt niin jätin tehtävän tähän. 


## Lähteet:


Tero Karvinen, 2026. Luettavissa: https://terokarvinen.com/application-hacking/#laksyt


Github, 2026. Luettavissa: https://github.com/NationalSecurityAgency/ghidra/releases


GHIDRA for Reverse Engineering (PicoCTF 2022 #42 'bbbloat') John Hammond, 2023. Katsottavissa: https://www.youtube.com/watch?v=oTD_ki86c9I




